% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core-set_gdal_auth.R
\name{set_gdal_auth}
\alias{set_gdal_auth}
\alias{set_gdal_auth.default}
\alias{set_gdal_auth.s3}
\alias{set_gdal_auth.azure}
\alias{set_gdal_auth.gs}
\alias{set_gdal_auth.oss}
\alias{set_gdal_auth.swift_v3}
\alias{set_gdal_auth.swift_v1}
\title{Set GDAL VSI Handler Authentication}
\usage{
set_gdal_auth(handler, ...)

\method{set_gdal_auth}{default}(handler, ...)

\method{set_gdal_auth}{s3}(
  handler,
  access_key_id = NULL,
  secret_access_key = NULL,
  session_token = NULL,
  region = NULL,
  no_sign_request = FALSE,
  ...
)

\method{set_gdal_auth}{azure}(
  handler,
  connection_string = NULL,
  account = NULL,
  access_key = NULL,
  sas_token = NULL,
  no_sign_request = FALSE,
  ...
)

\method{set_gdal_auth}{gs}(handler, credentials_file = NULL, no_sign_request = FALSE, ...)

\method{set_gdal_auth}{oss}(
  handler,
  endpoint = NULL,
  access_key_id = NULL,
  secret_access_key = NULL,
  session_token = NULL,
  no_sign_request = FALSE,
  ...
)

\method{set_gdal_auth}{swift_v3}(
  handler,
  auth_url,
  username,
  password,
  project_name,
  project_domain_name = "default",
  ...
)

\method{set_gdal_auth}{swift_v1}(handler, auth_v1_url, user, key, ...)
}
\arguments{
\item{handler}{Character string identifying the authentication handler (e.g., "s3",
"azure", "gs"). Dispatches to an S3 method that sets appropriate environment
variables.}

\item{...}{Handler-specific authentication arguments. See method documentation.}

\item{access_key_id}{AWS Access Key ID for S3}

\item{secret_access_key}{AWS Secret Access Key for S3}

\item{session_token}{Optional AWS session token for temporary credentials}

\item{region}{Optional AWS region identifier}

\item{no_sign_request}{For S3 method, allow unsigned (public) bucket access}

\item{connection_string}{For Azure method, storage connection string}

\item{account}{For Azure method, storage account name}

\item{access_key}{For Azure method, storage access key}

\item{sas_token}{For Azure method, SAS token}

\item{credentials_file}{For GCS method, path to service account JSON file}

\item{endpoint}{For OSS method, endpoint URL}

\item{auth_url}{For Swift method, authentication URL}

\item{username}{For Swift method, username}

\item{password}{For Swift method, password}

\item{project_name}{For Swift method, project name}

\item{project_domain_name}{For Swift method, project domain}

\item{auth_v1_url}{For Swift V1 method, auth V1 URL}

\item{user}{For Swift V1 method, username}

\item{key}{For Swift V1 method, API key}
}
\value{
Invisibly returns \code{TRUE} on success. Raises an error if authentication setup fails
or required parameters are missing.
}
\description{
\code{set_gdal_auth()} is an S3 generic method for setting up authentication credentials
for GDAL VSI handlers. Rather than embedding credentials in \code{vsi_url()} calls,
this function configures environment variables that GDAL reads automatically.

This design improves security (credentials are not hardcoded in scripts) and follows
GDAL's native architecture. Call this function once per R session before composing
or using VSI URLs.
}
\details{
\subsection{azure: Microsoft Azure Blob Storage}{

\strong{GDAL Version:} ≥ 3.0.0 (3.6.1+ recommended)

\strong{Authentication Methods (choose exactly one):}
\enumerate{
\item \strong{Connection String} (simplest):

\if{html}{\out{<div class="sourceCode r">}}\preformatted{set_gdal_auth("azure", connection_string = "DefaultEndpointsProtocol=https;...")
}\if{html}{\out{</div>}}
\item \strong{Account + Access Key}:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{set_gdal_auth("azure", account = "myaccount", access_key = "...")
}\if{html}{\out{</div>}}
\item \strong{Account + SAS Token}:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{set_gdal_auth("azure", account = "myaccount", sas_token = "st=2019...")
}\if{html}{\out{</div>}}

Note: Leading \verb{?} or \code{&} and trailing \code{&} are automatically stripped.
\item \strong{Public Container Access}:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{set_gdal_auth("azure", no_sign_request = TRUE)
}\if{html}{\out{</div>}}
}

\strong{Parameters:}
\itemize{
\item \code{connection_string}: Character string or NULL. Full connection string from Azure portal.
\item \code{account}: Character string or NULL. Storage account name.
\item \code{access_key}: Character string or NULL. Account access key.
\item \code{sas_token}: Character string or NULL. SAS token (automatically sanitized).
\item \code{no_sign_request}: Logical. For public containers. Default FALSE.
}
}

\subsection{gs: Google Cloud Storage}{

\strong{GDAL Version:} ≥ 3.0.0 (3.6.1+ recommended)

\strong{Recommended Method: Service Account JSON File}

The simplest and most standard way to authenticate is to use a service account
credentials file (downloaded from Google Cloud Console).

\strong{Parameters:}
\itemize{
\item \code{credentials_file}: Character string or NULL. Path to a JSON credentials file
(service account or authorized user). Default NULL.
\item \code{no_sign_request}: Logical. For public buckets. Default FALSE.
}

\strong{Environment Variable Set:}
\itemize{
\item \code{GOOGLE_APPLICATION_CREDENTIALS} (if credentials_file provided)
\item \code{GS_NO_SIGN_REQUEST} (if no_sign_request=TRUE)
}
}

\subsection{oss: Alibaba Cloud OSS}{

\strong{GDAL Version:} ≥ 3.0.0 (3.6.1+ recommended)

\strong{Environment Variables Set:}
\itemize{
\item \code{OSS_ENDPOINT} (required)
\item \code{OSS_ACCESS_KEY_ID}
\item \code{OSS_SECRET_ACCESS_KEY}
\item \code{OSS_SESSION_TOKEN} (if temporary credentials)
\item \code{OSS_NO_SIGN_REQUEST} (if public bucket)
}

\strong{Parameters:}
\itemize{
\item \code{endpoint}: Character string. OSS endpoint URL (e.g., "http://oss-us-east-1.aliyuncs.com")
\item \code{access_key_id}: Character string or NULL
\item \code{secret_access_key}: Character string or NULL
\item \code{session_token}: Character string or NULL. For temporary credentials.
\item \code{no_sign_request}: Logical. For public buckets. Default FALSE.
}
}

\subsection{swift_v3: OpenStack Swift (Keystone V3 Authentication)}{

\strong{GDAL Version:} ≥ 3.0.0

\strong{Environment Variables Set:}
\itemize{
\item \code{OS_IDENTITY_API_VERSION=3} (required for V3)
\item \code{OS_AUTH_URL}
\item \code{OS_USERNAME}
\item \code{OS_PASSWORD}
\item \code{OS_PROJECT_NAME}
\item \code{OS_PROJECT_DOMAIN_NAME}
}

\strong{Parameters:}
\itemize{
\item \code{auth_url}: Character string. Keystone V3 authentication endpoint
\item \code{username}: Character string. OpenStack username
\item \code{password}: Character string. OpenStack password
\item \code{project_name}: Character string. Project name
\item \code{project_domain_name}: Character string. Project domain name. Default "default".
}
}

\subsection{swift_v1: OpenStack Swift (Auth V1)}{

\strong{GDAL Version:} ≥ 3.0.0

\strong{Environment Variables Set:}
\itemize{
\item \code{SWIFT_AUTH_V1_URL}
\item \code{SWIFT_USER}
\item \code{SWIFT_KEY}
}

\strong{Parameters:}
\itemize{
\item \code{auth_v1_url}: Character string. Auth V1 endpoint (e.g., "http://swift.example.com/auth/v1.0")
\item \code{user}: Character string. Swift user/account
\item \code{key}: Character string. Swift key/password
}
}
}
\section{Supported Handlers}{

\itemize{
\item \strong{s3}: AWS S3 and S3-compatible storage
\item \strong{azure}: Microsoft Azure Blob Storage
\item \strong{gs}: Google Cloud Storage
\item \strong{oss}: Alibaba Cloud OSS
\item \strong{swift_v1}: OpenStack Swift (Auth V1)
\item \strong{swift_v3}: OpenStack Swift (Keystone V3)
}
}

\section{Security Considerations}{

\itemize{
\item Credentials are stored in R's environment (visible via \code{Sys.getenv()}). Avoid
saving R sessions containing set credentials to disk.
\item For production use, consider using credential files or instance metadata instead
of passing credentials directly (see method documentation).
\item Never hardcode credentials in published scripts.
}
}

\examples{
\dontrun{
# Set S3 credentials for AWS
set_gdal_auth("s3",
  access_key_id = "AKIAIOSFODNN7EXAMPLE",
  secret_access_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
)

# Now use vsi_url() without credentials
url <- vsi_url("vsis3", bucket = "my-bucket", key = "data.tif")

# Set Azure credentials
set_gdal_auth("azure", connection_string = "DefaultEndpointsProtocol=https;...")

# Set GCS credentials from service account file
set_gdal_auth("gs", credentials_file = "~/credentials.json")
}

\dontrun{
# Permanent credentials
set_gdal_auth("s3",
  access_key_id = "AKIAIOSFODNN7EXAMPLE",
  secret_access_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
)

# Temporary credentials (from STS)
set_gdal_auth("s3",
  access_key_id = "...",
  secret_access_key = "...",
  session_token = "...",
  region = "us-west-2"
)

# Public bucket (no authentication)
set_gdal_auth("s3", no_sign_request = TRUE)
}
\dontrun{
# Using connection string (recommended)
set_gdal_auth("azure",
  connection_string = "DefaultEndpointsProtocol=https;AccountName=..."
)

# Using account and access key
set_gdal_auth("azure", account = "myaccount", access_key = "...")

# Using SAS token (? and & are auto-stripped)
set_gdal_auth("azure", account = "myaccount", sas_token = "?st=2019...")
}
\dontrun{
# Service account (recommended)
set_gdal_auth("gs", credentials_file = "~/gcp-credentials.json")

# Public bucket
set_gdal_auth("gs", no_sign_request = TRUE)
}
\dontrun{
set_gdal_auth("oss",
  endpoint = "http://oss-us-east-1.aliyuncs.com",
  access_key_id = "...",
  secret_access_key = "..."
)
}
\dontrun{
set_gdal_auth("swift_v3",
  auth_url = "http://keystone.example.com:5000/v3",
  username = "user",
  password = "pass",
  project_name = "admin",
  project_domain_name = "Default"
)
}
\dontrun{
set_gdal_auth("swift_v1",
  auth_v1_url = "http://swift.example.com/auth/v1.0",
  user = "testuser",
  key = "testkey"
)
}
}
